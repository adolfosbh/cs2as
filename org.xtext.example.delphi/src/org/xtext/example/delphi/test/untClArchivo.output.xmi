<?xml version="1.0" encoding="ASCII"?>
<xmi:XMI xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:astm="http://modelum.es/modernization/astm">
  <astm:ExpressionStatement>
    <expression xsi:type="astm:BinaryExpression">
      <operator xsi:type="astm:Assign"/>
      <leftOperand xsi:type="astm:IdentifierReference">
        <name nameString="cbSize"/>
      </leftOperand>
      <rightOperand xsi:type="astm:DelphiFunctionCallExpression">
        <calledFunction xsi:type="astm:IdentifierReference">
          <name nameString="SizeOf"/>
        </calledFunction>
      </rightOperand>
    </expression>
  </astm:ExpressionStatement>
  <astm:ExpressionStatement>
    <expression xsi:type="astm:BinaryExpression">
      <operator xsi:type="astm:Assign"/>
      <leftOperand xsi:type="astm:IdentifierReference">
        <name nameString="fMask"/>
      </leftOperand>
      <rightOperand xsi:type="astm:IdentifierReference">
        <name nameString="SEE_MASK_NOCLOSEPROCESS"/>
      </rightOperand>
    </expression>
  </astm:ExpressionStatement>
  <astm:ExpressionStatement>
    <expression xsi:type="astm:BinaryExpression">
      <operator xsi:type="astm:Assign"/>
      <leftOperand xsi:type="astm:IdentifierReference">
        <name nameString="wnd"/>
      </leftOperand>
      <rightOperand xsi:type="astm:QualifiedOverData">
        <name nameString="Application"/>
      </rightOperand>
    </expression>
  </astm:ExpressionStatement>
  <astm:ExpressionStatement/>
  <astm:ExpressionStatement>
    <expression xsi:type="astm:BinaryExpression">
      <operator xsi:type="astm:Assign"/>
      <leftOperand xsi:type="astm:IdentifierReference">
        <name nameString="lpFile"/>
      </leftOperand>
      <rightOperand xsi:type="astm:DelphiFunctionCallExpression">
        <calledFunction xsi:type="astm:IdentifierReference">
          <name nameString="PChar"/>
        </calledFunction>
      </rightOperand>
    </expression>
  </astm:ExpressionStatement>
  <astm:ExpressionStatement>
    <expression xsi:type="astm:BinaryExpression">
      <operator xsi:type="astm:Assign"/>
      <leftOperand xsi:type="astm:IdentifierReference">
        <name nameString="lpParameters"/>
      </leftOperand>
      <rightOperand xsi:type="astm:DelphiFunctionCallExpression">
        <calledFunction xsi:type="astm:IdentifierReference">
          <name nameString="Pchar"/>
        </calledFunction>
      </rightOperand>
    </expression>
  </astm:ExpressionStatement>
  <astm:ExpressionStatement/>
  <astm:ExpressionStatement>
    <expression xsi:type="astm:BinaryExpression">
      <operator xsi:type="astm:Assign"/>
      <leftOperand xsi:type="astm:IdentifierReference">
        <name nameString="nShow"/>
      </leftOperand>
      <rightOperand xsi:type="astm:IdentifierReference">
        <name nameString="Visibilidad"/>
      </rightOperand>
    </expression>
  </astm:ExpressionStatement>
  <astm:ExpressionStatement>
    <expression xsi:type="astm:BinaryExpression">
      <operator xsi:type="astm:Assign"/>
      <leftOperand xsi:type="astm:IdentifierReference">
        <name nameString="hInstApp"/>
      </leftOperand>
      <rightOperand xsi:type="astm:IntegerLiteral" value="0"/>
    </expression>
  </astm:ExpressionStatement>
  <astm:ExpressionStatement>
    <expression xsi:type="astm:BinaryExpression">
      <operator xsi:type="astm:Assign"/>
      <leftOperand xsi:type="astm:IdentifierReference">
        <name nameString="idruta"/>
      </leftOperand>
      <rightOperand xsi:type="astm:QualifiedOverData">
        <name nameString="f"/>
      </rightOperand>
    </expression>
  </astm:ExpressionStatement>
  <astm:ExpressionStatement>
    <expression xsi:type="astm:BinaryExpression">
      <operator xsi:type="astm:Assign"/>
      <leftOperand xsi:type="astm:IdentifierReference">
        <name nameString="nombre"/>
      </leftOperand>
      <rightOperand xsi:type="astm:QualifiedOverData">
        <name nameString="f"/>
      </rightOperand>
    </expression>
  </astm:ExpressionStatement>
  <astm:ExpressionStatement/>
  <astm:ExpressionStatement/>
  <astm:ExpressionStatement/>
  <astm:ExpressionStatement/>
  <astm:ExpressionStatement>
    <expression xsi:type="astm:BinaryExpression">
      <operator xsi:type="astm:Assign"/>
      <leftOperand xsi:type="astm:IdentifierReference">
        <name nameString="res"/>
      </leftOperand>
      <rightOperand xsi:type="astm:DelphiFunctionCallExpression">
        <calledFunction xsi:type="astm:IdentifierReference">
          <name nameString="BorraArchivo"/>
        </calledFunction>
      </rightOperand>
    </expression>
  </astm:ExpressionStatement>
  <astm:ExpressionStatement>
    <expression xsi:type="astm:BinaryExpression">
      <operator xsi:type="astm:Assign"/>
      <leftOperand xsi:type="astm:IdentifierReference">
        <name nameString="result"/>
      </leftOperand>
      <rightOperand xsi:type="astm:IntegerLiteral" value="6"/>
    </expression>
  </astm:ExpressionStatement>
  <astm:ExpressionStatement/>
  <astm:ExpressionStatement/>
  <astm:ExpressionStatement/>
  <astm:ExpressionStatement/>
  <astm:ExpressionStatement/>
  <astm:ExpressionStatement/>
  <astm:ExpressionStatement/>
  <astm:ExpressionStatement/>
  <astm:ExpressionStatement/>
  <astm:ExpressionStatement/>
  <astm:ExpressionStatement/>
  <astm:ExpressionStatement/>
  <astm:IdentifierReference>
    <name nameString="Info"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="Handle"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="lpVerb"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="Ejecutable"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="Argumentos"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="lpDirectory"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="RutaDoc"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="idruta"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="Create"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="ShowModal"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="ruta"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="fichero"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="Free"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="close"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="commandtext"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="idruta"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="open"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="IsEmpty"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="AsString"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="close"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="close"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="CommandText"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="proyecto"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="modulo"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="open"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="IsEmpty"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="AsString"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="close"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="close"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="CommandText"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="proyecto"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="open"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="IsEmpty"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="AsString"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="close"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="close"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="CommandText"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="proyecto"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="modulo"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="Submod"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="open"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="IsEmpty"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="AsString"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="close"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="Ruta"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="ruta"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="ruta"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="ruta"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="ruta"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="ruta"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="IsEmpty"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="State"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="Delete"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="ruta"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="ApplyUpdates"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="ruta"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="cds"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="exit"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="Info"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="Info"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="Info"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="Info"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="Info"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="Info"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="Info"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="Info"/>
  </astm:IdentifierReference>
  <astm:IdentifierReference>
    <name nameString="Info"/>
  </astm:IdentifierReference>
  <astm:QualifiedOverData>
    <name nameString="f"/>
  </astm:QualifiedOverData>
  <astm:QualifiedOverData>
    <name nameString="cds"/>
  </astm:QualifiedOverData>
  <astm:QualifiedOverData>
    <name nameString="cds"/>
  </astm:QualifiedOverData>
  <astm:DelphiFunctionCallExpression>
    <calledFunction xsi:type="astm:IdentifierReference">
      <name nameString="QuotedStr"/>
    </calledFunction>
  </astm:DelphiFunctionCallExpression>
  <astm:DelphiFunctionCallExpression>
    <calledFunction xsi:type="astm:IdentifierReference">
      <name nameString="QuotedStr"/>
    </calledFunction>
  </astm:DelphiFunctionCallExpression>
  <astm:DelphiFunctionCallExpression>
    <calledFunction xsi:type="astm:IdentifierReference">
      <name nameString="QuotedStr"/>
    </calledFunction>
  </astm:DelphiFunctionCallExpression>
  <astm:DelphiFunctionCallExpression>
    <calledFunction xsi:type="astm:IdentifierReference">
      <name nameString="QuotedStr"/>
    </calledFunction>
  </astm:DelphiFunctionCallExpression>
  <astm:DelphiFunctionCallExpression>
    <calledFunction xsi:type="astm:IdentifierReference">
      <name nameString="QuotedStr"/>
    </calledFunction>
  </astm:DelphiFunctionCallExpression>
  <astm:DelphiFunctionCallExpression>
    <calledFunction xsi:type="astm:IdentifierReference">
      <name nameString="QuotedStr"/>
    </calledFunction>
  </astm:DelphiFunctionCallExpression>
  <astm:DelphiFunctionCallExpression>
    <calledFunction xsi:type="astm:IdentifierReference">
      <name nameString="FileExists"/>
    </calledFunction>
  </astm:DelphiFunctionCallExpression>
  <astm:DelphiFunctionCallExpression>
    <calledFunction xsi:type="astm:IdentifierReference">
      <name nameString="RenameFile"/>
    </calledFunction>
  </astm:DelphiFunctionCallExpression>
  <astm:IntegerLiteral value="#0"/>
  <astm:IntegerLiteral value="0"/>
  <astm:IntegerLiteral value="0"/>
  <astm:IntegerLiteral value="0"/>
  <astm:IntegerLiteral value="0"/>
  <astm:StringLiteral value="'SELECT SRUTA FROM FSRUTAS '"/>
  <astm:StringLiteral value="' WHERE IDRUTA = '"/>
  <astm:StringLiteral value="'SELECT IDRUTA FROM FSMODULO '"/>
  <astm:StringLiteral value="' WHERE IDPROJEC = '"/>
  <astm:StringLiteral value="' AND IDMODULO = '"/>
  <astm:StringLiteral value="'SELECT IDRUTA FROM FSPROJEC '"/>
  <astm:StringLiteral value="' WHERE IDPROJEC = '"/>
  <astm:StringLiteral value="'SELECT IDRUTA FROM FSSUBMOD '"/>
  <astm:StringLiteral value="' WHERE IDPROJEC = '"/>
  <astm:StringLiteral value="' AND IDMODULO = '"/>
  <astm:StringLiteral value="' AND IDSUBMOD = '"/>
  <astm:StringLiteral value="'borrado'"/>
  <astm:StringLiteral value="'borrado'"/>
  <astm:StringLiteral value="'borrado'"/>
  <astm:IfStatement>
    <thenBody xsi:type="astm:ExpressionStatement">
      <expression xsi:type="astm:BinaryExpression">
        <operator xsi:type="astm:Assign"/>
        <leftOperand xsi:type="astm:IdentifierReference">
          <name nameString="result"/>
        </leftOperand>
        <rightOperand xsi:type="astm:QualifiedOverData">
          <name nameString="Fields"/>
        </rightOperand>
      </expression>
    </thenBody>
  </astm:IfStatement>
  <astm:IfStatement>
    <thenBody xsi:type="astm:ExpressionStatement">
      <expression xsi:type="astm:BinaryExpression">
        <operator xsi:type="astm:Assign"/>
        <leftOperand xsi:type="astm:IdentifierReference">
          <name nameString="result"/>
        </leftOperand>
        <rightOperand xsi:type="astm:QualifiedOverData">
          <name nameString="Fields"/>
        </rightOperand>
      </expression>
    </thenBody>
  </astm:IfStatement>
  <astm:IfStatement>
    <thenBody xsi:type="astm:ExpressionStatement">
      <expression xsi:type="astm:BinaryExpression">
        <operator xsi:type="astm:Assign"/>
        <leftOperand xsi:type="astm:IdentifierReference">
          <name nameString="result"/>
        </leftOperand>
        <rightOperand xsi:type="astm:QualifiedOverData">
          <name nameString="Fields"/>
        </rightOperand>
      </expression>
    </thenBody>
  </astm:IfStatement>
  <astm:IfStatement>
    <thenBody xsi:type="astm:ExpressionStatement">
      <expression xsi:type="astm:BinaryExpression">
        <operator xsi:type="astm:Assign"/>
        <leftOperand xsi:type="astm:IdentifierReference">
          <name nameString="result"/>
        </leftOperand>
        <rightOperand xsi:type="astm:QualifiedOverData">
          <name nameString="Fields"/>
        </rightOperand>
      </expression>
    </thenBody>
  </astm:IfStatement>
  <astm:IfStatement>
    <condition xsi:type="astm:DelphiFunctionCallExpression">
      <calledFunction xsi:type="astm:IdentifierReference">
        <name nameString="deleteFile"/>
      </calledFunction>
    </condition>
    <thenBody xsi:type="astm:ExpressionStatement">
      <expression xsi:type="astm:BinaryExpression">
        <operator xsi:type="astm:Assign"/>
        <leftOperand xsi:type="astm:IdentifierReference">
          <name nameString="result"/>
        </leftOperand>
        <rightOperand xsi:type="astm:IntegerLiteral" value="0"/>
      </expression>
    </thenBody>
    <elseBody xsi:type="astm:ExpressionStatement">
      <expression xsi:type="astm:BinaryExpression">
        <operator xsi:type="astm:Assign"/>
        <leftOperand xsi:type="astm:IdentifierReference">
          <name nameString="result"/>
        </leftOperand>
        <rightOperand xsi:type="astm:IntegerLiteral" value="3"/>
      </expression>
    </elseBody>
  </astm:IfStatement>
  <astm:IfStatement>
    <elseBody xsi:type="astm:ExpressionStatement">
      <expression xsi:type="astm:BinaryExpression">
        <operator xsi:type="astm:Assign"/>
        <leftOperand xsi:type="astm:IdentifierReference">
          <name nameString="result"/>
        </leftOperand>
        <rightOperand xsi:type="astm:IntegerLiteral" value="8"/>
      </expression>
    </elseBody>
  </astm:IfStatement>
  <astm:IfStatement>
    <condition xsi:type="astm:BinaryExpression">
      <operator xsi:type="astm:Equal"/>
      <leftOperand xsi:type="astm:QualifiedOverData">
        <name nameString="cds"/>
      </leftOperand>
      <rightOperand xsi:type="astm:IdentifierReference">
        <name nameString="dsBrowse"/>
      </rightOperand>
    </condition>
    <elseBody xsi:type="astm:ExpressionStatement">
      <expression xsi:type="astm:BinaryExpression">
        <operator xsi:type="astm:Assign"/>
        <leftOperand xsi:type="astm:IdentifierReference">
          <name nameString="result"/>
        </leftOperand>
        <rightOperand xsi:type="astm:IntegerLiteral" value="9"/>
      </expression>
    </elseBody>
  </astm:IfStatement>
  <astm:IfStatement>
    <elseBody xsi:type="astm:ExpressionStatement">
      <expression xsi:type="astm:BinaryExpression">
        <operator xsi:type="astm:Assign"/>
        <leftOperand xsi:type="astm:IdentifierReference">
          <name nameString="result"/>
        </leftOperand>
        <rightOperand xsi:type="astm:IdentifierReference">
          <name nameString="res"/>
        </rightOperand>
      </expression>
    </elseBody>
  </astm:IfStatement>
  <astm:IfStatement>
    <condition xsi:type="astm:BinaryExpression">
      <operator xsi:type="astm:Equal"/>
      <leftOperand xsi:type="astm:DelphiFunctionCallExpression">
        <calledFunction xsi:type="astm:QualifiedOverData">
          <name nameString="cds"/>
        </calledFunction>
        <actualParams xsi:type="astm:ActualParameterExpression">
          <value xsi:type="astm:IntegerLiteral" value="0"/>
        </actualParams>
      </leftOperand>
      <rightOperand xsi:type="astm:IntegerLiteral" value="0"/>
    </condition>
    <thenBody xsi:type="astm:ExpressionStatement">
      <expression xsi:type="astm:BinaryExpression">
        <operator xsi:type="astm:Assign"/>
        <leftOperand xsi:type="astm:IdentifierReference">
          <name nameString="result"/>
        </leftOperand>
        <rightOperand xsi:type="astm:IntegerLiteral" value="0"/>
      </expression>
    </thenBody>
    <elseBody xsi:type="astm:ExpressionStatement">
      <expression xsi:type="astm:BinaryExpression">
        <operator xsi:type="astm:Assign"/>
        <leftOperand xsi:type="astm:IdentifierReference">
          <name nameString="result"/>
        </leftOperand>
        <rightOperand xsi:type="astm:IntegerLiteral" value="5"/>
      </expression>
    </elseBody>
  </astm:IfStatement>
  <astm:IfStatement>
    <condition xsi:type="astm:BinaryExpression">
      <operator xsi:type="astm:Equal"/>
      <leftOperand xsi:type="astm:IdentifierReference">
        <name nameString="result"/>
      </leftOperand>
      <rightOperand xsi:type="astm:IntegerLiteral" value="5"/>
    </condition>
    <thenBody xsi:type="astm:ExpressionStatement">
      <expression xsi:type="astm:FunctionCallExpression">
        <calledFunction xsi:type="astm:QualifiedOverData">
          <name nameString="TMensa"/>
        </calledFunction>
        <actualParams xsi:type="astm:ActualParameterExpression">
          <value xsi:type="astm:StringLiteral" value="'Se ha borrado el archivo en disco duro pero no el registro en base de datos'"/>
        </actualParams>
      </expression>
    </thenBody>
    <elseBody xsi:type="astm:IfStatement">
      <condition xsi:type="astm:BinaryExpression">
        <operator xsi:type="astm:Equal"/>
        <leftOperand xsi:type="astm:IdentifierReference">
          <name nameString="result"/>
        </leftOperand>
        <rightOperand xsi:type="astm:IntegerLiteral" value="6"/>
      </condition>
      <thenBody xsi:type="astm:ExpressionStatement">
        <expression xsi:type="astm:FunctionCallExpression">
          <calledFunction xsi:type="astm:QualifiedOverData">
            <name nameString="TMensa"/>
          </calledFunction>
          <actualParams xsi:type="astm:ActualParameterExpression">
            <value xsi:type="astm:StringLiteral" value="'Ha ocurrido un error inesperado'"/>
          </actualParams>
        </expression>
      </thenBody>
      <elseBody xsi:type="astm:IfStatement">
        <condition xsi:type="astm:BinaryExpression">
          <operator xsi:type="astm:Equal"/>
          <leftOperand xsi:type="astm:IdentifierReference">
            <name nameString="result"/>
          </leftOperand>
          <rightOperand xsi:type="astm:IntegerLiteral" value="2"/>
        </condition>
        <thenBody xsi:type="astm:ExpressionStatement">
          <expression xsi:type="astm:FunctionCallExpression">
            <calledFunction xsi:type="astm:QualifiedOverData">
              <name nameString="TMensa"/>
            </calledFunction>
            <actualParams xsi:type="astm:ActualParameterExpression">
              <value xsi:type="astm:StringLiteral" value="'El archivo est&#xfffd; bloqueado, no puede borrarse'"/>
            </actualParams>
          </expression>
        </thenBody>
        <elseBody xsi:type="astm:IfStatement">
          <condition xsi:type="astm:BinaryExpression">
            <operator xsi:type="astm:Equal"/>
            <leftOperand xsi:type="astm:IdentifierReference">
              <name nameString="result"/>
            </leftOperand>
            <rightOperand xsi:type="astm:IntegerLiteral" value="3"/>
          </condition>
          <thenBody xsi:type="astm:ExpressionStatement">
            <expression xsi:type="astm:FunctionCallExpression">
              <calledFunction xsi:type="astm:QualifiedOverData">
                <name nameString="TMensa"/>
              </calledFunction>
              <actualParams xsi:type="astm:ActualParameterExpression">
                <value xsi:type="astm:StringLiteral" value="'Ha ocurrido un error inesperado borrando el archivo del disco duro'"/>
              </actualParams>
            </expression>
          </thenBody>
          <elseBody xsi:type="astm:IfStatement">
            <condition xsi:type="astm:BinaryExpression">
              <operator xsi:type="astm:Equal"/>
              <leftOperand xsi:type="astm:IdentifierReference">
                <name nameString="result"/>
              </leftOperand>
              <rightOperand xsi:type="astm:IntegerLiteral" value="4"/>
            </condition>
            <thenBody xsi:type="astm:ExpressionStatement">
              <expression xsi:type="astm:FunctionCallExpression">
                <calledFunction xsi:type="astm:QualifiedOverData">
                  <name nameString="TMensa"/>
                </calledFunction>
                <actualParams xsi:type="astm:ActualParameterExpression">
                  <value xsi:type="astm:StringLiteral" value="'Ha ocurrido un error borrando el archivo este ha sido renombrado con sufijo &quot;borrado&quot;'"/>
                </actualParams>
              </expression>
            </thenBody>
            <elseBody xsi:type="astm:IfStatement">
              <condition xsi:type="astm:BinaryExpression">
                <operator xsi:type="astm:Equal"/>
                <leftOperand xsi:type="astm:IdentifierReference">
                  <name nameString="result"/>
                </leftOperand>
                <rightOperand xsi:type="astm:IntegerLiteral" value="7"/>
              </condition>
              <thenBody xsi:type="astm:ExpressionStatement">
                <expression xsi:type="astm:FunctionCallExpression">
                  <calledFunction xsi:type="astm:QualifiedOverData">
                    <name nameString="TMensa"/>
                  </calledFunction>
                  <actualParams xsi:type="astm:ActualParameterExpression">
                    <value xsi:type="astm:StringLiteral" value="'Recibido Dataset nulo'"/>
                  </actualParams>
                </expression>
              </thenBody>
              <elseBody xsi:type="astm:IfStatement">
                <condition xsi:type="astm:BinaryExpression">
                  <operator xsi:type="astm:Equal"/>
                  <leftOperand xsi:type="astm:IdentifierReference">
                    <name nameString="result"/>
                  </leftOperand>
                  <rightOperand xsi:type="astm:IntegerLiteral" value="8"/>
                </condition>
                <thenBody xsi:type="astm:ExpressionStatement">
                  <expression xsi:type="astm:FunctionCallExpression">
                    <calledFunction xsi:type="astm:QualifiedOverData">
                      <name nameString="TMensa"/>
                    </calledFunction>
                    <actualParams xsi:type="astm:ActualParameterExpression">
                      <value xsi:type="astm:StringLiteral" value="'Dataset Vacio'"/>
                    </actualParams>
                  </expression>
                </thenBody>
                <elseBody xsi:type="astm:IfStatement">
                  <condition xsi:type="astm:BinaryExpression">
                    <operator xsi:type="astm:Equal"/>
                    <leftOperand xsi:type="astm:IdentifierReference">
                      <name nameString="result"/>
                    </leftOperand>
                    <rightOperand xsi:type="astm:IntegerLiteral" value="9"/>
                  </condition>
                  <thenBody xsi:type="astm:ExpressionStatement">
                    <expression xsi:type="astm:FunctionCallExpression">
                      <calledFunction xsi:type="astm:QualifiedOverData">
                        <name nameString="TMensa"/>
                      </calledFunction>
                      <actualParams xsi:type="astm:ActualParameterExpression">
                        <value xsi:type="astm:StringLiteral" value="'Dataset en estado no valido'"/>
                      </actualParams>
                    </expression>
                  </thenBody>
                  <elseBody xsi:type="astm:ExpressionStatement">
                    <expression xsi:type="astm:FunctionCallExpression">
                      <calledFunction xsi:type="astm:QualifiedOverData">
                        <name nameString="TMensa"/>
                      </calledFunction>
                      <actualParams xsi:type="astm:ActualParameterExpression">
                        <value xsi:type="astm:StringLiteral" value="'Error no controlado'"/>
                      </actualParams>
                    </expression>
                  </elseBody>
                </elseBody>
              </elseBody>
            </elseBody>
          </elseBody>
        </elseBody>
      </elseBody>
    </elseBody>
  </astm:IfStatement>
  <astm:Project>
    <files xsi:type="astm:DelphiUnit" language="Delphi">
      <locationInfo>
        <inSourceFile/>
      </locationInfo>
      <name nameString="untClArchivo"/>
      <interface>
        <fragments xsi:type="astm:VariableDefinition">
          <identifierName nameString="FILWORD"/>
          <initialValue xsi:type="astm:IntegerLiteral" value="1"/>
        </fragments>
        <fragments xsi:type="astm:VariableDefinition">
          <identifierName nameString="FILEXCEL"/>
          <initialValue xsi:type="astm:IntegerLiteral" value="2"/>
        </fragments>
      </interface>
      <implementation>
        <fragments xsi:type="astm:FunctionDefinition">
          <identifierName nameString="TArchivo"/>
          <body xsi:type="astm:DelphiBlockStatement"/>
        </fragments>
        <fragments xsi:type="astm:FunctionDefinition">
          <identifierName nameString="TArchivo"/>
          <body xsi:type="astm:DelphiBlockStatement">
            <subStatements xsi:type="astm:ExpressionStatement">
              <expression xsi:type="astm:BinaryExpression">
                <operator xsi:type="astm:Assign"/>
                <leftOperand xsi:type="astm:IdentifierReference">
                  <name nameString="pInfo"/>
                </leftOperand>
                <rightOperand xsi:type="astm:IdentifierReference">
                  <name nameString="Info"/>
                </rightOperand>
              </expression>
            </subStatements>
            <subStatements xsi:type="astm:DelphiWithStatement"/>
            <subStatements xsi:type="astm:ExpressionStatement">
              <expression xsi:type="astm:FunctionCallExpression">
                <calledFunction xsi:type="astm:IdentifierReference">
                  <name nameString="ShellExecuteEx"/>
                </calledFunction>
                <actualParams xsi:type="astm:ActualParameterExpression">
                  <value xsi:type="astm:IdentifierReference">
                    <name nameString="pInfo"/>
                  </value>
                </actualParams>
              </expression>
            </subStatements>
          </body>
        </fragments>
        <fragments xsi:type="astm:FunctionDefinition">
          <identifierName nameString="TArchivo"/>
          <body xsi:type="astm:DelphiBlockStatement">
            <subStatements xsi:type="astm:ExpressionStatement">
              <expression xsi:type="astm:BinaryExpression">
                <operator xsi:type="astm:Assign"/>
                <leftOperand xsi:type="astm:IdentifierReference">
                  <name nameString="result"/>
                </leftOperand>
                <rightOperand xsi:type="astm:DelphiFunctionCallExpression">
                  <calledFunction xsi:type="astm:QualifiedOverData">
                    <name nameString="dmDatos"/>
                  </calledFunction>
                </rightOperand>
              </expression>
            </subStatements>
          </body>
        </fragments>
        <fragments xsi:type="astm:FunctionDefinition">
          <identifierName nameString="TArchivo"/>
          <body xsi:type="astm:DelphiBlockStatement">
            <subStatements xsi:type="astm:ExpressionStatement">
              <expression xsi:type="astm:BinaryExpression">
                <operator xsi:type="astm:Assign"/>
                <leftOperand xsi:type="astm:IdentifierReference">
                  <name nameString="f"/>
                </leftOperand>
                <rightOperand xsi:type="astm:DelphiFunctionCallExpression">
                  <calledFunction xsi:type="astm:QualifiedOverData">
                    <name nameString="TFrmSelFil"/>
                  </calledFunction>
                </rightOperand>
              </expression>
            </subStatements>
            <subStatements xsi:type="astm:TryStatement">
              <guardedStatement xsi:type="astm:IfStatement">
                <condition xsi:type="astm:BinaryExpression">
                  <operator xsi:type="astm:Equal"/>
                  <leftOperand xsi:type="astm:QualifiedOverData">
                    <name nameString="f"/>
                  </leftOperand>
                  <rightOperand xsi:type="astm:IdentifierReference">
                    <name nameString="mrOk"/>
                  </rightOperand>
                </condition>
              </guardedStatement>
              <finalStatement xsi:type="astm:ExpressionStatement"/>
            </subStatements>
          </body>
        </fragments>
        <fragments xsi:type="astm:FunctionDefinition">
          <identifierName nameString="TArchivo"/>
          <body xsi:type="astm:DelphiBlockStatement">
            <subStatements xsi:type="astm:DelphiWithStatement"/>
          </body>
        </fragments>
        <fragments xsi:type="astm:FunctionDefinition">
          <identifierName nameString="TArchivo"/>
          <body xsi:type="astm:DelphiBlockStatement">
            <subStatements xsi:type="astm:DelphiWithStatement"/>
          </body>
        </fragments>
        <fragments xsi:type="astm:FunctionDefinition">
          <identifierName nameString="TArchivo"/>
          <body xsi:type="astm:DelphiBlockStatement">
            <subStatements xsi:type="astm:DelphiWithStatement"/>
          </body>
        </fragments>
        <fragments xsi:type="astm:FunctionDefinition">
          <identifierName nameString="TArchivo"/>
          <body xsi:type="astm:DelphiBlockStatement">
            <subStatements xsi:type="astm:DelphiWithStatement"/>
          </body>
        </fragments>
        <fragments xsi:type="astm:FunctionDefinition">
          <identifierName nameString="TArchivo"/>
          <body xsi:type="astm:DelphiBlockStatement">
            <subStatements xsi:type="astm:IfStatement">
              <thenBody xsi:type="astm:ExpressionStatement">
                <expression xsi:type="astm:BinaryExpression">
                  <operator xsi:type="astm:Assign"/>
                  <leftOperand xsi:type="astm:IdentifierReference">
                    <name nameString="result"/>
                  </leftOperand>
                  <rightOperand xsi:type="astm:IntegerLiteral" value="1"/>
                </expression>
              </thenBody>
              <elseBody xsi:type="astm:IfStatement">
                <condition xsi:type="astm:DelphiFunctionCallExpression">
                  <calledFunction xsi:type="astm:IdentifierReference">
                    <name nameString="RenameFile"/>
                  </calledFunction>
                </condition>
                <elseBody xsi:type="astm:ExpressionStatement">
                  <expression xsi:type="astm:BinaryExpression">
                    <operator xsi:type="astm:Assign"/>
                    <leftOperand xsi:type="astm:IdentifierReference">
                      <name nameString="result"/>
                    </leftOperand>
                    <rightOperand xsi:type="astm:IntegerLiteral" value="2"/>
                  </expression>
                </elseBody>
              </elseBody>
            </subStatements>
            <subStatements xsi:type="astm:IfStatement">
              <condition xsi:type="astm:BinaryExpression">
                <operator xsi:type="astm:Equal"/>
                <leftOperand xsi:type="astm:IdentifierReference">
                  <name nameString="result"/>
                </leftOperand>
                <rightOperand xsi:type="astm:IntegerLiteral" value="3"/>
              </condition>
              <thenBody xsi:type="astm:IfStatement">
                <thenBody xsi:type="astm:ExpressionStatement">
                  <expression xsi:type="astm:BinaryExpression">
                    <operator xsi:type="astm:Assign"/>
                    <leftOperand xsi:type="astm:IdentifierReference">
                      <name nameString="result"/>
                    </leftOperand>
                    <rightOperand xsi:type="astm:IntegerLiteral" value="4"/>
                  </expression>
                </thenBody>
              </thenBody>
            </subStatements>
          </body>
        </fragments>
        <fragments xsi:type="astm:FunctionDefinition">
          <identifierName nameString="TArchivo"/>
          <body xsi:type="astm:DelphiBlockStatement">
            <subStatements xsi:type="astm:IfStatement">
              <condition xsi:type="astm:BinaryExpression">
                <leftOperand xsi:type="astm:IdentifierReference">
                  <name nameString="cds"/>
                </leftOperand>
              </condition>
              <elseBody xsi:type="astm:ExpressionStatement">
                <expression xsi:type="astm:BinaryExpression">
                  <operator xsi:type="astm:Assign"/>
                  <leftOperand xsi:type="astm:IdentifierReference">
                    <name nameString="result"/>
                  </leftOperand>
                  <rightOperand xsi:type="astm:IntegerLiteral" value="7"/>
                </expression>
              </elseBody>
            </subStatements>
          </body>
        </fragments>
        <fragments xsi:type="astm:FunctionDefinition">
          <identifierName nameString="TArchivo"/>
          <body xsi:type="astm:DelphiBlockStatement">
            <subStatements xsi:type="astm:ExpressionStatement">
              <expression xsi:type="astm:BinaryExpression">
                <operator xsi:type="astm:Assign"/>
                <leftOperand xsi:type="astm:IdentifierReference">
                  <name nameString="result"/>
                </leftOperand>
                <rightOperand xsi:type="astm:DelphiFunctionCallExpression">
                  <calledFunction xsi:type="astm:IdentifierReference">
                    <name nameString="BorraArchivo"/>
                  </calledFunction>
                </rightOperand>
              </expression>
            </subStatements>
            <subStatements xsi:type="astm:IfStatement">
              <condition xsi:type="astm:BinaryExpression">
                <operator xsi:type="astm:Equal"/>
                <leftOperand xsi:type="astm:IdentifierReference">
                  <name nameString="result"/>
                </leftOperand>
                <rightOperand xsi:type="astm:IntegerLiteral" value="0"/>
              </condition>
              <thenBody xsi:type="astm:ExpressionStatement"/>
            </subStatements>
          </body>
        </fragments>
      </implementation>
    </files>
  </astm:Project>
  <astm:BinaryExpression>
    <operator xsi:type="astm:Equal"/>
    <leftOperand xsi:type="astm:IdentifierReference">
      <name nameString="res"/>
    </leftOperand>
    <rightOperand xsi:type="astm:IntegerLiteral" value="0"/>
  </astm:BinaryExpression>
  <astm:BinaryExpression>
    <operator xsi:type="astm:Equal"/>
    <leftOperand xsi:type="astm:IdentifierReference">
      <name nameString="res"/>
    </leftOperand>
    <rightOperand xsi:type="astm:IntegerLiteral" value="1"/>
  </astm:BinaryExpression>
  <astm:TryStatement>
    <guardedStatement xsi:type="astm:ExpressionStatement"/>
  </astm:TryStatement>
  <astm:TypeDefinition>
    <name nameString="TArchivo"/>
  </astm:TypeDefinition>
  <astm:VariableDefinition isMutable="true">
    <identifierName nameString="Info"/>
  </astm:VariableDefinition>
  <astm:VariableDefinition isMutable="true">
    <identifierName nameString="pInfo"/>
  </astm:VariableDefinition>
  <astm:VariableDefinition isMutable="true">
    <identifierName nameString="f"/>
  </astm:VariableDefinition>
  <astm:VariableDefinition isMutable="true">
    <identifierName nameString="res"/>
  </astm:VariableDefinition>
</xmi:XMI>
