import ClassesCS: 'ClassesCS.ecore'::classescs;
import ClassesAS: 'Classes.ecore'::classes;
import ClassesCS2ClassesAS: 'ClassesCS2ClassesAS.ecore'::cCS2cAS;

transformation classesCS2classesAS {
    cAS imports ClassesAS;
    cCS imports ClassesCS;
    middle imports ClassesCS2ClassesAS;    
}

map rootCS2rootAS_LM in classesCS2classesAS {
    check cCS (rootCS : RootCS) {}    
    enforce middle () {
    	realize r2r : RootCS2RootAS
    }
    
    where () {
    	r2r.rootCS := rootCS;
    }
}

map rootCS2rootAS_MR in classesCS2classesAS {
	check middle(r2r : RootCS2RootAS){}
	enforce cAS() {
		realize rootAS : Root 
	}
	
	where () {
		r2r.rootAS := rootAS;
	}
}

map packageCS2packageAS_LM in classesCS2classesAS {
    check cCS (packageCS : PackageCS) {}    
    enforce middle () {
    	realize p2p : PackageCS2PackageAS
    }
    
    where () {
    	p2p.packageCS := packageCS;    	
    }
}

map packageCS2packageAS_MR in classesCS2classesAS {
	check middle(p2p : PackageCS2PackageAS) {}
	enforce cAS() {
		realize packageAS : Package 
	}
	
	where () {
		p2p.packageAS := packageAS;
	}
}

map rootAS_ownedPackages in classesCS2classesAS {
	check cAS(rootAS : Root, packageAS : Package) {}
	check middle(r2r : RootCS2RootAS, p2p : PackageCS2PackageAS) {}
	where (	r2r.rootAS = rootAS;
			p2p.packageAS = packageAS;
			r2r.rootCS.ownedPackages->includes(p2p.packageCS);
	) {
		rootAS.ownedPackages := rootAS.ownedPackages->including(packageAS);
	}
}

map packageAS_name in classesCS2classesAS {
	check cAS(packageAS : Package) {}
	check middle(p2p : PackageCS2PackageAS) {}
	where (p2p.packageAS = packageAS;)
	{
		packageAS.name := p2p.packageCS.name;
	}
}