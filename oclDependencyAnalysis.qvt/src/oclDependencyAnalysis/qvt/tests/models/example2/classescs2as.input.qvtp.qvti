import ClassesCS: 'ClassesCS.ecore'::classescs;
import ClassesAS: 'Classes.ecore'::classes;
import ClassesCS2ClassesAS: 'classescs2as.ecore'::classescstraces;

transformation classesCS2classesAS {
    cAS imports ClassesAS;
    cCS imports ClassesCS;
    middle imports ClassesCS2ClassesAS;    
}

map rootCS2rootAS_LM in classesCS2classesAS {
    check cCS (rootCS : RootCS) {}    
    enforce middle () {
    	realize r2r : RootCS2Root
    }
    
    where () {
    	r2r.rootCS := rootCS;
    }
}

map rootCS2rootAS_MR in classesCS2classesAS {
	check middle(r2r : RootCS2Root){}
	enforce cAS() {
		realize root : Root 
	}
	
	where () {
		r2r.root := root;
	}
}

map packageCS2packageAS_LM in classesCS2classesAS {
    check cCS (packageCS : PackageCS) {}
    enforce middle () {
    	realize p2p : PackageCS2Package
    }
    
    where () {
    	p2p.packageCS := packageCS;    	
    }
}

map packageCS2packageAS_MR in classesCS2classesAS {
	check middle(p2p : PackageCS2Package) {}
	enforce cAS() {
		realize package : Package 
	}
	
	where () {
		p2p.package := package;
	}
}

map rootAS_ownedPackages in classesCS2classesAS {
	check cAS(root : Root) {}
	check cCS(rootCS : RootCS) {}
	where (rootCS.RootCS2Root.root = root;)
	{
		root.ownedPackages := rootCS.ownedPackages->collect(pCS | pCS.PackageCS2Package.package);
	}
}

map packageAS_name in classesCS2classesAS {
	check cAS(package : Package) {}
	check cCS(packageCS : PackageCS) {}
	where (package.PackageCS2Package.packageCS = packageCS;)
	{
		package.name := packageCS.name;
	}
}